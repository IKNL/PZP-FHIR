map "http://hl7.org/fhir/StructureMap/CoverageEligibilityRequest4to3" = "R4 to R3 Conversion for (Coverage)EligibilityRequest"

uses "http://hl7.org/fhir/StructureDefinition/CoverageEligibilityRequest" alias CoverageEligibilityRequest as source
uses "http://hl7.org/fhir/3.0/StructureDefinition/EligibilityRequest" alias EligibilityRequestR3 as target

imports "http://hl7.org/fhir/StructureMap/*4to3"

group CoverageEligibilityRequest(source src : CoverageEligibilityRequestR3, target tgt : EligibilityRequest) extends DomainResource <<type+>> {
  src.identifier as vs -> tgt.identifier as vt then Identifier(vs, vt);
  src.status as vs -> tgt.status as vt then code(vs, vt);
  src.priority as vs -> tgt.priority as vt then string(vs, vt);
  src.patient as vs -> tgt.patient as vt then string(vs, vt);
  src.serviced as vs -> tgt.serviced as vt then string(vs, vt);
  src.created as vs -> tgt.created as vt then dateTime(vs, vt);
  src.enterer as vs -> tgt.enterer as vt then string(vs, vt);
  src.provider as vs -> tgt.provider as vt then string(vs, vt);
  src.insurer as vs -> tgt.insurer as vt then string(vs, vt);
  src.facility as vs -> tgt.facility as vt then string(vs, vt);
  src.insurance as s then {
    s.coverage where (s.focal = true) -> tgt.coverage;
    s.businessArrangement where (s.focal = true) -> tgt.businessArrangement;
  };
  src.item as i then {
    i.category -> tgt.benefitCategory;
  };
}

