map "http://hl7.org/fhir/StructureMap/GraphDefinition4to3" = "R4 to R3 Conversion for GraphDefinition"

uses "http://hl7.org/fhir/StructureDefinition/GraphDefinition" alias GraphDefinition as source
uses "http://hl7.org/fhir/3.0/StructureDefinition/GraphDefinition" alias GraphDefinitionR3 as target

imports "http://hl7.org/fhir/StructureMap/*4to3"

group GraphDefinition(source src : GraphDefinition, target tgt : GraphDefinitionR3) extends DomainResource <<type+>> {
  src.url as vs -> tgt.url as vt then uri(vs, vt);
  src.version as vs -> tgt.version as vt then string(vs, vt);
  src.name as vs -> tgt.name as vt then string(vs, vt);
  src.status as vs -> tgt.status as vt then code(vs, vt);
  src.experimental as vs -> tgt.experimental as vt then boolean(vs, vt);
  src.date as vs -> tgt.date as vt then dateTime(vs, vt);
  src.publisher as vs -> tgt.publisher as vt then string(vs, vt);
  src.contact -> tgt.contact;
  src.description as vs -> tgt.description as vt then markdown(vs, vt);
  src.useContext as vs -> tgt.useContext as vt then string(vs, vt);
  src.jurisdiction as vs -> tgt.jurisdiction as vt then string(vs, vt);
  src.purpose as vs -> tgt.purpose as vt then markdown(vs, vt);
  src.start as vs -> tgt.start as vt then dateTime(vs, vt);
  src.profile as vs -> tgt.profile as vt then canonical(vs, vt);
  src.link as vs0 -> tgt.link as vt0 then link(vs0, vt0);
}

group link(source src, target tgt) extends BackboneElement {
  src.path as vs -> tgt.path as vt then string(vs, vt);
  src.sliceName as vs -> tgt.sliceName as vt then string(vs, vt);
  src.min as vs -> tgt.min as vt then string(vs, vt);
  src.max as vs -> tgt.max as vt then string(vs, vt);
  src.description as vs -> tgt.description as vt then markdown(vs, vt);
  src.target as vs0 -> tgt.target as vt0 then target(vs0, vt0);
}

group target(source src, target tgt) extends BackboneElement {
  src.type as vs -> tgt.type as vt then string(vs, vt);
  src.profile as vs -> tgt.profile as vt then canonical(vs, vt);
  src.compartment as vs0 where use = 'requirement' -> tgt.compartment as vt0 then compartment(vs0, vt0);
  src.link as vs0 -> tgt.link as vt0 then link(vs0, vt0);
}

group compartment(source src, target tgt) extends BackboneElement {
  src.code as vs -> tgt.code as vt then CodeableConcept(vs, vt);
  src.rule as vs -> tgt.rule as vt then string(vs, vt);
  src.expression as vs -> tgt.expression as vt then string(vs, vt);
  src.description as vs -> tgt.description as vt then markdown(vs, vt);
}

